!function(){function Video(video){this.elem=video.el,this.id=video.id,this.volume=this.elem.volume}Video.prototype.createControl=function(options){for(var el=document.createElement(options.tag),i=0;i<options.attrs.length;i++)el.setAttribute(options.attrs[i].name,options.attrs[i].value);return el},Video.prototype.getControl=function(selector){return document.querySelector(".controls__"+selector+"_"+this.id)},Video.prototype.init=function(){var wrapper=document.createElement("div"),controls=document.createElement("div"),title=document.createElement("p"),progress=self.createControl({tag:"progress",attrs:[{name:"class",value:"controls__progress"},{name:"data-video",value:video.id},{name:"max",value:100},{name:"value",value:0}]}),play=self.createControl({tag:"span",attrs:[{name:"class",value:"controls__item controls__play"},{name:"data-video",value:video.id}]}),audio=self.createControl({tag:"div",attrs:[{name:"class",value:"controls__item controls__audio-block"}]}),mute=self.createControl({tag:"span",attrs:[{name:"class",value:"controls__mute"},{name:"data-video",value:video.id}]}),rangeWrapper=self.createControl({tag:"label",attrs:[{name:"class",value:"controls__range-wrapper"}]}),range=self.createControl({tag:"input",attrs:[{name:"class",value:"controls__volume"},{name:"type",value:"range"},{name:"data-video",value:video.id},{name:"min",value:0},{name:"max",value:1},{name:"step",value:.01},{name:"value",value:1}]}),time=self.createControl({tag:"span",attrs:[{name:"class",value:"controls__item controls__time"},{name:"data-video",value:video.id}]}),fullscreen=self.createControl({tag:"span",attrs:[{name:"class",value:"controls__item controls__fullscreen"},{name:"data-video",value:video.id}]}),elements=self.createControl({tag:"div",attrs:[{name:"class",value:"controls__elements"}]});title.classList.add("video__title"),title.textContent=video.el.title,controls.classList.add("controls"),rangeWrapper.appendChild(range),audio.appendChild(mute),audio.appendChild(rangeWrapper),elements.appendChild(play),elements.appendChild(audio),elements.appendChild(time),elements.appendChild(fullscreen),controls.appendChild(progress),controls.appendChild(elements),wrapper.appendChild(title),wrapper.appendChild(el),wrapper.appendChild(controls),wrapper.classList.add("video"),document.body.appendChild(wrapper)}();var volume=getControl("volume"),mute=getControl("mute"),play=getControl("play"),progress=getControl("progress"),time=getControl("time"),fullScreen=getControl("fullscreen");Video.prototype.getHumanReadableTime=function(time){var dirtyTime=time?time:el.duration,minutes=parseInt(dirtyTime/60),seconds=dirtyTime-60*parseInt(minutes);return minutes=10>minutes?"0"+minutes:minutes,seconds=10>seconds?"0"+seconds:seconds,minutes+":"+seconds},Video.prototype.playPause=function(){return el.paused?el.play():el.pause(),this},Video.prototype.mute=function(){return 0!==el.volume?(el.volume=0,volume.value=0):(el.volume=tempVolume,volume.value=tempVolume),this},Video.prototype.remove=function(){return el.remove(),this.remove(),!1},this.changeVolume=function(value){return el.volume=tempVolume=value,this},this.updateProgressbar=function(){return progress.value=Math.floor(100/el.duration*el.currentTime),!1},this.goToPosition=function(percents){el.currentTime=parseInt(percents/100*el.duration)},this.getVideo=function(){return el},this.togglePlayClass=function(){play.classList.toggle("controls__play_paused")},this.fullScreen=function(){el.requestFullscreen?el.requestFullscreen():el.mozRequestFullScreen?el.mozRequestFullScreen():el.webkitRequestFullscreen?el.webkitRequestFullscreen():el.msRequestFullscreen&&el.msRequestFullscreen()},el.addEventListener("loadedmetadata",function(){time.textContent=self.getHumanReadableTime()},!1),range.addEventListener("change",function(){self.changeVolume(this.value)},!1),mute.addEventListener("click",function(){self.mute(),this.classList.toggle("controls__mute_on")},!1),play.addEventListener("click",function(){self.playPause(),self.togglePlayClass()},!1),el.addEventListener("ended",function(){self.togglePlayClass()}),el.addEventListener("timeupdate",function(){time.textContent=self.getHumanReadableTime(el.currentTime),self.updateProgressbar()},!1),progress.addEventListener("click",function(e){var coords=Math.floor(100/this.offsetWidth*e.offsetX);self.goToPosition(coords),this.value=coords,el.paused&&el.play()},!1),fullScreen.addEventListener("click",function(){self.fullScreen()},!1);var VideoFactory=function(){};VideoFactory.prototype.createVideo=function(video){return new Video(video)};for(var factory=new VideoFactory,videos=document.querySelectorAll("video"),videosLen=videos.length,newArr=[],i=0;videosLen>i;i+=1)newArr.push(factory.createVideo({el:videos[i],id:i}))}();